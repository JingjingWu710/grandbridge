{% extends "layout.html" %} {% block content %}
<h2>ğŸŒ± Guided Planting (Simulation)</h2>
<div class="alert alert-info" role="alert">
  <h5>ğŸŒ± Why Plant a Vegetable?</h5>
  <p>
    Sometimes caregiving is tough. This guided planting is a way to <strong>record what youâ€™ve done today</strong>.
    Just like a real seed, your small effort will grow. When you â€œharvestâ€ the vegetable, 
    youâ€™ll be reminded that <strong>you made progress today</strong> â€” and thatâ€™s worth celebrating. ğŸ‰
  </p>
</div>
<p class="text-muted">
  Fill out this mock form to simulate planting a vegetable.
</p>


<form id="fake-plant-form">
  <div class="form-group">
    <p class="text-muted">
  Give your vegetables a special name ;)
</p>
    <label for="veg-name">Vegetable Name</label>
    <input
      type="text"
      class="form-control"
      id="veg-name"
      placeholder="e.g. Alice"
      required
    />
  </div>

<div class="form-group">
  <p class="text-muted">
  Choose a type!
</p>
  <label for="veg-type">Type</label>
  <select class="form-control" id="veg-type" required>
    <option value="" disabled selected>Choose your vegetable</option>
    <option value="carrot">Carrot</option>
    <option value="potato">Potato</option>
    <option value="spinach">Spinach</option>
    <option value="cabbage">Cabbage</option>
    <option value="tomato">Tomato</option>
  </select>
</div>

  <div class="form-group">
    <p class="text-muted">
  Write down your effort.
</p>
    <label for="veg-note">What did you do today?</label>
    <textarea
      class="form-control"
      id="veg-note"
      rows="2"
      placeholder="e.g. Fed the babies."
    ></textarea>
  </div>

  <button type="submit" class="btn btn-success">ğŸŒ¿ Plant</button>
</form>

<div id="simulation" style="display: none" class="mt-4">
  <h4 id="sim-name-type"></h4>
  <p id="sim-note"></p>

  <img
    id="sim-image"
    src="{{ url_for('static', filename='pics/seed.png') }}"
    alt="Seed"
    data-seed="{{ url_for('static', filename='pics/seed.png') }}"
    data-sprout="{{ url_for('static', filename='pics/sprout.png') }}"
    data-harvest="{{ url_for('static', filename='pics/harvest.png') }}"
    class="img-fluid mb-3"
    style="max-height: 300px"
  />

  <div id="sim-message" class="mb-2"></div>
  <button id="grow-btn" class="btn btn-primary">Click to Grow</button>
  <div id="harvest-notice" style="display: none" class="mt-3">
    <p>
      ğŸŒ¼ Click <strong>Your Effort Garden</strong> after it's harvested to check
      all that youâ€™ve grown so far.
    </p>
    <a href="{{ url_for('planting.plant') }}" class="btn btn-outline-success"
      >Back to Real Growing</a
    >
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("fake-plant-form");
    const simulation = document.getElementById("simulation");
    const simNameType = document.getElementById("sim-name-type");
    const simNote = document.getElementById("sim-note");
    const image = document.getElementById("sim-image");
    const growBtn = document.getElementById("grow-btn");
    const simMessage = document.getElementById("sim-message");

    let stageIndex = 0;
    const stages = ["seed", "sprout", "harvest"];

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      // Get values from form
      const name = document.getElementById("veg-name").value;
      const type = document.getElementById("veg-type").value;
      const note = document.getElementById("veg-note").value;

      // Show simulation area
      simNameType.textContent = `${name} (${type})`;
      simNote.textContent = note;
      simulation.style.display = "block";
      form.style.display = "none";

      // Reset to seed
      image.src = image.dataset.seed;
      image.alt = "Seed";
      stageIndex = 0;
      simMessage.textContent = "";
      growBtn.disabled = false;
    });

    growBtn.addEventListener("click", function () {
      stageIndex += 1;

      if (stageIndex === 1) {
        image.src = image.dataset.sprout;
        image.alt = "Sprout";
        simMessage.textContent = "ğŸŒ± Itâ€™s sprouting!";
      } else if (stageIndex === 2) {
        image.src = image.dataset.harvest;
        image.alt = "Harvested";
        simMessage.textContent = "ğŸ‰ Harvested!";
        growBtn.disabled = true;
        document.getElementById('harvest-notice').style.display = 'block';
      }
    });
  });
</script>
{% endblock %}
